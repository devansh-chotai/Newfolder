{% extends 'base.html' %}

{% block content %}

{% include 'breadcrumbs.html' %}

<div class="row">
	<b>{{product.productimage_set}}</b><br>
	<b>{{product.productimage_set.first}}</b><br>
	<b>{{product.productimage_set.first.image}}</b><br>
	<div class="col-xs-12 col-sm-3">
		<div class="thumbnail">
			<img src="/media/{{ product.productimage_set.first.image }}" alt="{{ product.title }}"/
>		</div>
		<div class="thumbnail">
			<img src="/media/{{ product.productimage_set.second.image }}" alt="{{ product.title }}"/
>		</div>
		<div class="thumbnail">
			<img src="/media/{{ product.productimage_set.last.image }}" alt="{{ product.title }}"/
>		</div>	
		<div class="caption text-center">
			<form method="POST" action='{% url "my_cart" %}'>
				{% csrf_token %}
				<input type="hidden" name="product" value={{product.slug}} />

			 	{% if product.productvariation_set.all %}

				 	{% if product.productvariation_set.sizes %}
				 	<select class='form-control' name='size'>
				 	{% for item in product.productvariation_set.sizes %}
				 		<option value='{{ item.id }}'>{{ item.title }}</option>
				 		{% endfor %}
				 	</select>
				 	{% endif %}

				 	 {% if product.productvariation_set.colors %}
				 	<select class='form-control' name='color'>
				 	{% for item in product.productvariation_set.colors %}
				 		<option value='{{ item.id }}'>{{ item.title }}</option>
				 		{% endfor %}
				 	</select>
				 	{% endif %}

			 	{% endif %}

				<input type="number" min="1" max="9" value="1" name="quantity" class="form-control">
				<br>
				<button id="cart" type="submit" class="btn btn-success">Add to Cart</button><br><br>
				<span id="login" style="display: none;">You must first <a href="{% url 'user_login' %}">Log in</a></span>
			</form>
		</div>		
	</div>
	<div class="col-xs-12 col-sm-9">
		<h3>{{ product.title }}</h3>
		<p><span><b>&#8377;</b>  {{ product.price }}</span></p>
		<p>{{ product.description }}</p>
	</div>
</div>

{% if user.is_authenticated %}
{% else %}
<script>
document.getElementById("cart").addEventListener("click", function(e){
  e.preventDefault();
  document.getElementById('login').style.removeProperty("display");
});
</script>
{% endif %}


{% endblock %}

